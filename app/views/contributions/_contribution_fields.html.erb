<% content_for :header do %>

  <%= javascript_include_tag 'vendor/tiny_mce/jquery.tinymce.js' %>

  <script type='text/javascript'> 
    //<![CDATA[

    function init_tiny_mce(JqueryListOfElements){
      $(JqueryListOfElements).tinymce({
        script_url : '/javascripts/vendor/tiny_mce/tiny_mce.js',
        mode : "textareas",
        //theme : "simple",
        theme : "advanced",
        // turned off autoresize because it doesn't seem to work very well
        //plugins : 'autoresize',
        width : '100%',
		theme_advanced_buttons1 : "bold,italic,underline,strikethrough,|,link,unlink,|,bullist,numlist,|,undo,redo,|,cut,copy,paste",
        theme_advanced_buttons2 : "",
        theme_advanced_buttons3 : "",
		theme_advanced_toolbar_location : "top",
		theme_advanced_toolbar_align : "left",
      });
    }

    $(document).ready(function() {

      $('#contribution-add-link').click(function(event) {
        event.preventDefault();
        $('#conversation_contributions_attributes_0_url').toggle();
        if ('none' != $('#conversation_contributions_attributes_0_url').css('display')) {
          $('#conversation_contributions_attributes_0_url').focus();
        } else {
          $('#conversation_contributions_attributes_0_content').tinymce().focus();
        }
      });

      $('#contribution-add-file').click(function(event) {
        event.preventDefault();
        $('#conversation_contributions_attributes_0_attachment').toggle();
        if ('none' != $('#conversation_contributions_attributes_0_attachment').css('display')) {
          $('#conversation_contributions_attributes_0_attachment').focus();
        } else {
          $('#conversation_contributions_attributes_0_content').tinymce().focus();
        }
      });

      init_tiny_mce('#conversation_contributions_attributes_0_content');

    })(); // end document ready function

    //]]>
  </script>

<% end %>

<fieldset style="border-style: solid; border-width: 1px; border-color: #A9A9A9;text-align:left;">
  <%= form.fields_for :contributions, contributions do |f| %>

    <p>
    <%= f.text_area(:content, :placeholder => "Leave a Comment...", :class => 'tinymce') %>
    </p>

    <p>
    <a href="#" id="contribution-add-link">Add a link to a related website</a>
    <br />
    <%= f.text_field(:url, :type => "text", :class => "textbox link", :placeholder => "(Optional) Share a link...", :style => 'display:none;') %>
    </p>

    <p>
    <a href="#" id="contribution-add-file">Upload a photograph, document, or other file</a>
    <br />
    <%= f.file_field(:attachment, :style => 'display:none;') %>
    </p>

  <% end %>

</fieldset>
